---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
------
```{r}
library(dplyr)
library(ggplot2)

```



```{r}
data <- read.table("activity.csv",header=T,sep=",")
head(data)
```


```{r}
## What is mean total number of steps taken per day?
### 1. Calculate the total number of steps taken per day
dt <- data
steps_per_day <- aggregate(steps ~ date, data=dt, FUN=sum)
```


```{r}
head(steps_per_day)
```





```{r}
#Make a histogram of the total number of steps taken each day
hist(steps_per_day$steps, col="light blue",xlab = "Total steps daily", 
        main = "Number of steps per day")

```

```{r}
#Calculate the mean and median of the total number of steps taken per day
median(steps_per_day$steps,na.rm = TRUE)
mean(steps_per_day$steps,na.rm = TRUE)

```


```{r}
## What is the average daily activity pattern?
### 1. Make a time series plot (i.e. type = “l”) of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)
steps_i <- aggregate(steps ~ interval, data = dt, FUN = mean, na.rm = TRUE)
#steps_i$interval <- as.integer(levels(steps_i$interval)[steps_i$interval])
#colnames(steps_i) <- c("interval", "steps")
str(steps_i)
```


```{r}
#timeseries graph
plot(steps_i$interval,steps_i$steps,type="l",xlab="time",
        ylab="Average number of steps",main="Average daily activity pattern")
```

```{r}
#2. Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?
max_i <- steps_i[which.max(steps_i$steps),]
max_i
```

```{r}
## Imputing missing values
### 1. Calculate and report the total number of missing values in the dataset (i.e. the total number of rows with NAs)
cout_missing_values <- sum(is.na(dt$steps))
cout_missing_values
```







